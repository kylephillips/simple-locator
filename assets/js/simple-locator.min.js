var active_form="",formatted_address="",googlemaps_response="";function openInfoWindow(o){google.maps.event.trigger(SimpleLocator.markers[0][o],"click");var e=SimpleLocator.markers[0][o].getPosition().lat(),o=SimpleLocator.markers[0][o].getPosition().lng(),o=new google.maps.LatLng(e,o);return SimpleLocator.maps[0].panTo(o),SimpleLocator.maps[0].fitBounds(o),SimpleLocator.maps[0].setZoom(12),!1}function wpsl_before_submit(o,e){}function wpsl_after_render(o){}function wpsl_click_marker(o,e,t,a){}function wpsl_no_results(o,e){}function wpsl_error(o,e){}function wpsl_success(o,e,t){}function wpsl_googlemaps_response(){return googlemaps_response}function wpsl_all_locations_rendered(o){}function wpsl_all_locations_marker_clicked(o,e){}function wpsl_googlemaps_response(){return googlemaps_response}var SimpleLocator=SimpleLocator||{};SimpleLocator.SingleLocation=function(){var i=this,n=jQuery;return i.selectors={mapContainer:"data-simple-locator-single-map",latitude:"data-latitude",longitude:"data-longitude",title:"data-title"},i.bindEvents=function(){n(document).ready(function(){i.loadAllMaps()})},i.loadAllMaps=function(){var o=n("["+i.selectors.mapContainer+"]");n.each(o,function(){i.loadMap(n(this))})},i.loadMap=function(o){var e=parseFloat(n(o).attr(i.selectors.latitude)),t=parseFloat(n(o).attr(i.selectors.longitude)),a=n(o).attr(i.selectors.title),r=wpsl_locator.mappinsingle||"",e=new google.maps.LatLng(e,t),t={zoom:12,styles:wpsl_locator.mapstyles};(t="1"===wpsl_locator.custom_map_options?wpsl_locator.map_options:t).center=e;t=new google.maps.Map(o[0],t),a=new google.maps.Marker({position:e,map:t,icon:r,title:a});n(o).removeClass("loading"),n(document).trigger("simple-locator-single-map-rendered",[t,a,o])},i.bindEvents()},(SimpleLocator=SimpleLocator||{}).Form=function(){var s=this,l=jQuery;return s.activeForm,s.activeFormContainer,s.isWidget=!1,s.mapContainer,s.resultsContainer,s.formData,s.isAjax=!1,s.page=1,s.formIndex,s.bindEvents=function(){l(document).on("click","["+SimpleLocator.selectors.submitButton+"]",function(o){o.preventDefault(),s.activeForm=l(this).parents("["+SimpleLocator.selectors.form+"]"),s.activeFormContainer=l(this).parents("["+SimpleLocator.selectors.formContainer+"]"),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),s.setAjax(),active_form=s.activeForm,wpsl_before_submit(s.activeForm),l(document).trigger("simple-locator-before-submit",[s.activeForm]),s.processForm()}),l(document).on("simple-locator-submit-form",function(o,e){s.activeForm=e,s.activeFormContainer=l(e).parents("["+SimpleLocator.selectors.formContainer+"]"),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),s.setAjax(),active_form=s.activeForm,wpsl_before_submit(s.activeForm),l(document).trigger("simple-locator-before-submit",[s.activeForm]),s.processForm()}),l(document).on("simple-locator-geolocation-success",function(o,e,t){s.activeForm=l(e),s.activeFormContainer=l(e).parents("["+SimpleLocator.selectors.formContainer+"]"),l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(t.latitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(t.longitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val("1"),s.setAjax(),wpsl_before_submit(s.activeForm),l(s.activeFormContainer).removeClass("has-error"),l(document).trigger("simple-locator-before-submit",[s.activeForm]),s.setResultsContainers(),s.setFormData(),s.submitForm()}),l(document).on("simple-locator-address-geocoded",function(o,e,t){s.toggleLoading(!0,!0),void 0===s.activeForm&&(s.activeForm=t,s.activeFormContainer=l(t).parents("["+SimpleLocator.selectors.formContainer+"]"),s.setAjax()),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(e.latitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(e.longitude),l(s.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(e.formatted_address),s.setFormData(),s.submitForm()}),l(document).on("click","["+SimpleLocator.selectors.paginationButton+"]",function(o){s.activeForm&&(l(s.activeFormContainer).hasClass("has-geolocation")&&!s.isAjax||(o.preventDefault(),l(s.activeFormContainer).addClass("loading"),s.paginate(l(this))))}),l(document).on("simple-locator-autocomplete-changed",function(o,e,t){s.activeForm=l(t),s.activeFormContainer=l(t).parents("["+SimpleLocator.selectors.formContainer+"]"),s.setAjax(),s.toggleLoading(!0,!0),l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val(""),l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(e.geometry.location.lat()),l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(e.geometry.location.lng()),l(s.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(e.formatted_address),1<s.page&&(s.page=1),s.setFormData(),s.submitForm()}),l(document).on("submit","["+SimpleLocator.selectors.pageJumpForm+"]",function(o){var e=l(this).parents("["+SimpleLocator.selectors.resultsWrapper+"]");l(e).hasClass("non-ajax")||(o.preventDefault(),s.jumpToPage(l(this)))})},s.setAjax=function(){var o=l(s.activeForm).attr(SimpleLocator.selectors.ajaxForm);s.isAjax=void 0!==o&&"true"===o},s.processForm=function(o){l(s.activeFormContainer).removeClass("has-error"),s.toggleLoading(!0,!0),s.setResultsContainers(),(new SimpleLocator.Geocoder).getCoordinates(s.activeForm)},s.setResultsContainers=function(){0<l(s.activeForm).siblings("#widget").length&&(s.isWidget=!0),"undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options||(wpsl_locator_options=""),s.mapContainer=""===wpsl_locator_options.mapcont||s.isWidget?l(s.activeFormContainer).find("["+SimpleLocator.selectors.map+"]"):l(wpsl_locator_options.mapcont),s.resultsContainer=""===wpsl_locator_options.resultscontainer||s.isWidget?s.activeFormContainer.find("["+SimpleLocator.selectors.results+"]"):l(wpsl_locator_options.resultscontainer)},s.setFormData=function(){var o=void 0!==(o=l(s.activeForm).attr("data-simple-locator-form-allow-empty"))&&""!==o,e=void 0!==(e=l(s.activeForm).find("["+SimpleLocator.selectors.inputAddress+"]"))&&l(e).val(),t=void 0!==(t=l(s.activeForm).find("["+SimpleLocator.selectors.inputDistance+"]"))&&l(t).val(),a=""!==(a=l(s.activeForm).find("["+SimpleLocator.selectors.inputGeocode+"]").val())&&"false"!==a,r=""===(r=l(s.activeForm).find("["+SimpleLocator.selectors.inputLimit+"]").val())?null:r;if(s.formData={address:e,formatted_address:l(s.activeForm).find("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(),distance:t,latitude:l(s.activeForm).find("["+SimpleLocator.selectors.inputLatitude+"]").val(),longitude:l(s.activeForm).find("["+SimpleLocator.selectors.inputLongitude+"]").val(),unit:l(s.activeForm).find("["+SimpleLocator.selectors.inputUnit+"]").val(),geolocation:a,allow_empty_address:o,ajax:s.isAjax,per_page:r,page:s.page},s.setTaxonomies(),0!=wpsl_locator.postfields.length)for(var i=0;i<wpsl_locator.postfields.length;i++){var n=wpsl_locator.postfields[i];s.formData[n]=l("*[name="+n+"]").val()}},s.setTaxonomies=function(){var o=l(s.activeForm).find("[data-simple-locator-taxonomy-checkbox]:checked"),e=l(s.activeForm).find("[data-simple-locator-taxonomy-select]"),a={};l.each(e,function(o,e){""!==l(this).val()&&(a[l(this).attr("data-simple-locator-taxonomy-select")]=[l(this).val()])}),l.each(o,function(o,e){var t=l(this).attr("data-simple-locator-taxonomy-checkbox");a[t]instanceof Array||(a[t]=[]),a[t].push(parseInt(l(this).val()))}),s.formData.taxfilter=a},s.setAutoload=function(){var o=l(s.activeFormContainer).hasClass("has-geolocation");s.formData.autoload=o,s.formData.formmethod=l(s.activeForm).attr("method"),s.formData.resultspage=l(s.activeForm).find('input[name="results_page"]').val(),s.formData.mapheight=l(s.activeForm).find('input[name="mapheight"]').val(),s.formData.search_page=l(s.activeForm).find('input[name="search_page"]').val()},s.setFormIndex=function(){var o=l("["+SimpleLocator.selectors.form+"]");s.formIndex=l(s.activeForm).index(o)},s.submitForm=function(){s.setFormIndex(),s.setAutoload(),s.formData.ajax||s.formData.autoload?(s.formData.page=s.page,l.ajax({url:SimpleLocator.endpoints.search,type:"GET",datatype:"jsonp",data:s.formData,beforeSend:function(o,e){"1"===wpsl_locator.jsdebug&&(console.log("Form Data"),console.log(s.formData),console.log("URL"),console.log(e.url))},success:function(o){if(SimpleLocator.formData[s.formIndex]=o,SimpleLocator.formData[s.formIndex].allLocations=!1,"1"===wpsl_locator.jsdebug&&(console.log("Form Response"),console.log(o)),"error"===o.status)return l(document).trigger("simple-locator-error",[s.activeForm,o.message]),void s.toggleLoading(!1,!0);if(0===o.result_count){var e=wpsl_locator.nolocationserror+" "+o.formatted_address;return l(document).trigger("simple-locator-error",[s.activeForm,e,s.formData]),wpsl_no_results(s.formData.formatted_address,s.activeForm),void s.toggleLoading(!1,!0)}l(document).trigger("simple-locator-form-success",[o,s.activeForm]),wpsl_success(o.result_count,o.results,s.activeForm)},error:function(o){"1"===wpsl_locator.jsdebug&&(console.log("Form Response Error"),console.log(o.responseText))}})):l(s.activeForm).submit()},s.paginate=function(o){var e=l(o).parents("["+SimpleLocator.selectors.formContainer+"]"),e=l(e).index("["+SimpleLocator.selectors.formContainer+"]");if(!SimpleLocator.formData[e].allLocations){if("next"===l(o).attr(SimpleLocator.selectors.paginationButton))return s.page=s.page+1,void s.submitForm();s.page=s.page-1,s.submitForm()}},s.jumpToPage=function(o){var e=parseInt(l(o).find('input[type="tel"]').val());isNaN(e)||(s.activeFormContainer=l(o).parents("["+SimpleLocator.selectors.formContainer+"]"),s.activeForm=l(s.activeFormContainer).find("["+SimpleLocator.selectors.form+"]"),s.formIndex=l(s.activeFormContainer).index("["+SimpleLocator.selectors.formContainer+"]"),void 0!==(o=SimpleLocator.formData[s.formIndex].total_pages)&&o<e||void 0!==SimpleLocator.formData[s.formIndex]&&""!==SimpleLocator.formData[s.formIndex]&&(SimpleLocator.formData[s.formIndex].allLocations||(l(s.activeFormContainer).addClass("loading"),s.page=e,s.submitForm())))},s.toggleLoading=function(o,e){l(document).trigger("simple-locator-form-loading",[o]);var t=l(s.activeFormContainer).find("["+SimpleLocator.selectors.results+"]");if(o)return e&&(l("["+SimpleLocator.selectors.inputLatitude+"]").val(""),l("["+SimpleLocator.selectors.inputLongitude+"]").val(""),l("["+SimpleLocator.selectors.inputGeocode+"]").val(""),l("["+SimpleLocator.selectors.inputFormattedLocation+"]").val("")),l(s.activeFormContainer).addClass("loading"),l(s.activeFormContainer).find("["+SimpleLocator.selectors.formError+"]").hide(),void l(t).empty();l(s.activeFormContainer).removeClass("loading")},s.bindEvents()},(SimpleLocator=SimpleLocator||{}).Geocoder=function(){var t=this,a=jQuery;t.form,t.searchTerm,t.results=[],t.getCoordinates=function(o){t.form=o,t.searchTerm=a(t.form).find("["+SimpleLocator.selectors.inputAddress+"]").val();o=a(t.form).attr("data-simple-locator-form-allow-empty");void 0===o||"true"!=o||void 0!==t.searchTerm&&""!=t.searchTerm?"google"===SimpleLocator.mapservice&&t.queryGoogleMaps():a(document).trigger("simple-locator-address-geocoded",[t.results,t.form])},t.queryGoogleMaps=function(){geocoder=new google.maps.Geocoder,geocoder.geocode({address:t.searchTerm},function(o,e){e==google.maps.GeocoderStatus.OK?(googlemaps_response=o,t.results.latitude=o[0].geometry.location.lat(),t.results.longitude=o[0].geometry.location.lng(),t.results.formatted_address=o[0].formatted_address,"1"===wpsl_locator.jsdebug&&(console.log("Google Geocode Response"),console.log(t.results)),a(document).trigger("simple-locator-address-geocoded",[t.results,t.form])):(a(document).trigger("simple-locator-error",[t.form,wpsl_locator.notfounderror]),t.removeLoading())})},t.removeLoading=function(){a(t.form).parents("["+SimpleLocator.selectors.formContainer+"]").removeClass("loading")}},(SimpleLocator=SimpleLocator||{}).ResultsMapNonAjax=function(){var l=this,c=jQuery;return l.activeMap,l.activeWrapper,l.mapIndex,l.selectors={latitude:"data-latitude",longitude:"data-longitude"},l.bindEvents=function(){c(document).ready(function(){l.activeMap=c("["+SimpleLocator.selectors.mapNonAjax+"]"),l.activeMap.length<1||(l.toggleLoading(!0),l.setMapIndex(),l.loadMap())})},l.setMapIndex=function(){var o=c("["+SimpleLocator.selectors.resultsWrapper+"]");l.activeWrapper=c(l.activeMap).parents("["+SimpleLocator.selectors.resultsWrapper+"]"),l.mapIndex=c(l.activeWrapper).index(o),-1===l.mapIndex&&(l.mapIndex=0)},l.loadMap=function(){SimpleLocator.markers[l.mapIndex]=[];var o=new google.maps.LatLngBounds,e={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:wpsl_locator.mapstyles,panControl:!1};"1"===wpsl_locator.custom_map_options&&(e=wpsl_locator.map_options);var t=[],a=new google.maps.InfoWindow;SimpleLocator.infoWindow=a,SimpleLocator.maps[l.mapIndex]=new google.maps.Map(l.activeMap[0],e),l.addUserPin();for(var r=0;r<simple_locator_results.length;r++){var i={title:simple_locator_results[r].title,lat:simple_locator_results[r].lat,lng:simple_locator_results[r].lng,id:simple_locator_results[r].id,mappin:simple_locator_results[r].mappin,infowindow:simple_locator_results[r].infowindow};t.push(i)}for(r=0;r<t.length;r++){var n=new google.maps.LatLng(t[r].lat,t[r].lng);o.extend(n),n=new google.maps.Marker({position:n,map:SimpleLocator.maps[l.mapIndex],title:t[r].title,icon:t[r].mappin}),google.maps.event.addListener(n,"click",function(o,e){return function(){a.setContent(t[e].infowindow),a.open(SimpleLocator.maps[l.mapIndex],o),c(document).trigger("simple-locator-marker-clicked",[o,e,l.activeWrapper,t[e].id]),wpsl_click_marker(o,e,l.activeWrapper,t[e].id)}}(n,r)),SimpleLocator.markers[l.mapIndex].push(n)}""!==wpsl_locator.includeuserpin&&(e=l.addUserPin(),o.extend(e)),SimpleLocator.maps[l.mapIndex].fitBounds(o);var s=google.maps.event.addListener(SimpleLocator.maps[l.mapIndex],"idle",function(){simple_locator_results.length<2&&""===wpsl_locator.includeuserpin&&SimpleLocator.maps[l.mapIndex].setZoom(13),google.maps.event.removeListener(s)});l.toggleLoading(!1),c(document).trigger("simple-locator-map-rendered",[l.mapIndex,l.activeWrapper])},l.addUserPin=function(){SimpleLocator.userPin[l.mapIndex]&&(SimpleLocator.userPin[l.mapIndex].setMap(null),SimpleLocator.userPin[l.mapIndex]=null);var o=wpsl_locator.mappinuser||"",e=parseFloat(c(l.activeMap).attr(l.selectors.latitude)),t=parseFloat(c(l.activeMap).attr(l.selectors.longitude)),t=new google.maps.LatLng(e,t);return marker=new google.maps.Marker({position:t,map:SimpleLocator.maps[l.mapIndex],icon:o}),SimpleLocator.userPin[l.mapIndex]=marker,t},l.toggleLoading=function(o){o?c(l.activeMap).addClass("loading"):(c(l.activeMap).show(),c(l.activeMap).removeClass("loading"))},l.bindEvents()},(SimpleLocator=SimpleLocator||{}).ResultsMap=function(){var p=this,m=jQuery;return p.activeForm,p.activeFormContainer,p.activeMap,p.mapContainer,p.data,p.mapIndex,p.bindEvents=function(){m(document).on("simple-locator-form-success",function(o,e,t){p.activeForm=m(t),p.activeFormContainer=m(t).parents("["+SimpleLocator.selectors.formContainer+"]"),p.data=e,console.log(p.data),p.setMapContainer(),p.setMapIndex(),p.loadMap()})},p.setMapIndex=function(){var o=m("["+SimpleLocator.selectors.resultsWrapper+"]");p.mapIndex=m(o).index(p.activeFormContainer),-1===p.mapIndex&&(p.mapIndex=0)},p.setMapContainer=function(){var o=m(p.activeForm).attr("data-simple-locator-map-container");p.activeMap=void 0!==o&&""!==o?m(o):m(p.activeFormContainer).find("["+SimpleLocator.selectors.map+"]")},p.loadMap=function(){p.removeMapMarkers();var o,e=new google.maps.LatLngBounds,t=new google.maps.InfoWindow;SimpleLocator.infoWindow=t,SimpleLocator.maps[p.mapIndex]||(o=void 0!==(o=m(p.activeForm).attr("data-simple-locator-hide-map-controls"))&&""!==o,a=void 0===(a=m(p.activeForm).attr("data-simple-locator-map-control-position"))||""===a?"TOP_LEFT":a,a={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:wpsl_locator.mapstyles,panControl:!1,disableDefaultUI:o,zoomControlOptions:{position:google.maps.ControlPosition[a]}},"1"===wpsl_locator.custom_map_options&&(a=wpsl_locator.map_options),SimpleLocator.maps[p.mapIndex]=new google.maps.Map(p.activeMap[0],a));for(var a,r=[],i=0,n=p.data.results.length;i<n;i++){var s={title:p.data.results[i].title,lat:p.data.results[i].latitude,lng:p.data.results[i].longitude,id:p.data.results[i].id,mappin:p.data.results[i].mappin,infowindow:p.data.results[i].infowindow};r.push(s)}for(i=0;i<r.length;i++){var l=new google.maps.LatLng(r[i].lat,r[i].lng);e.extend(l),marker=new google.maps.Marker({position:l,map:SimpleLocator.maps[p.mapIndex],title:r[i].title,icon:r[i].mappin}),google.maps.event.addListener(marker,"click",function(o,e){return function(){t.setContent(r[e].infowindow),t.open(SimpleLocator.maps[p.mapIndex],o),m(document).trigger("simple-locator-marker-clicked",[o,e,p.activeForm,r[e].id]),wpsl_click_marker(o,e,p.activeForm,r[e].id)}}(marker,i)),SimpleLocator.markers[p.mapIndex].push(marker)}""===wpsl_locator.includeuserpin||(a=p.addUserPin())&&e.extend(a),SimpleLocator.maps[p.mapIndex].fitBounds(e);var c=google.maps.event.addListener(SimpleLocator.maps[p.mapIndex],"idle",function(){p.data.results.length<2&&""===wpsl_locator.includeuserpin&&SimpleLocator.maps[p.mapIndex].setZoom(13),google.maps.event.removeListener(c)});p.toggleLoading(!1),m(document).trigger("simple-locator-map-rendered",[p.mapIndex,p.activeForm])},p.addUserPin=function(){if(SimpleLocator.userPin[p.mapIndex]&&(SimpleLocator.userPin[p.mapIndex].setMap(null),SimpleLocator.userPin[p.mapIndex]=null),p.data.allow_empty_address&&""===p.data.address)return!1;var o=wpsl_locator.mappinuser||"",e=new google.maps.LatLng(p.data.latitude,p.data.longitude);return marker=new google.maps.Marker({position:e,map:SimpleLocator.maps[p.mapIndex],icon:o}),SimpleLocator.userPin[p.mapIndex]=marker,e},p.removeMapMarkers=function(){if(SimpleLocator.markers[p.mapIndex]){for(var o=0;o<SimpleLocator.markers[p.mapIndex].length;o++)SimpleLocator.markers[p.mapIndex][o].setMap(null);SimpleLocator.markers[p.mapIndex]=[]}else SimpleLocator.markers[p.mapIndex]=[]},p.toggleLoading=function(o){o?m(p.activeMap).addClass("loading"):(m(p.activeMap).show(),m(p.activeMap).removeClass("loading"))},p.bindEvents()},(SimpleLocator=SimpleLocator||{}).ResultsList=function(){var a=this,r=jQuery;return a.activeForm,a.activeFormContainer,a.activeList,a.data,a.listIndex,a.paginated=!1,a.bindEvents=function(){r(document).on("simple-locator-form-success",function(o,e,t){a.activeForm=r(t),a.activeFormContainer=r(t).parents("["+SimpleLocator.selectors.formContainer+"]"),a.data=e,0!==a.data.per_page&&(a.paginated=!0),a.setListContainer(),a.setMapIndex(),a.loadList()})},a.setMapIndex=function(){var o=r("["+SimpleLocator.selectors.resultsWrapper+"]");a.listIndex=r(a.activeFormContainer).index(o)},a.setListContainer=function(){var o=r(a.activeForm).attr("data-simple-locator-results-container");a.activeList=void 0!==o&&""!==o?r(o):r(a.activeFormContainer).find("["+SimpleLocator.selectors.results+"]")},a.loadList=function(){if(a.data.result_count<1)return r(a.activeFormContainer).find("["+SimpleLocator.selectors.error+"]").text(wpsl_locator_options.noresultstext).show(),r(a.activeList).hide(),r(a.activeFormContainer).find("["+SimpleLocator.selectors.map+"]").hide(),void wpsl_no_results(data.formatted_address,active_form);var o=1===a.data.result_count?wpsl_locator.location:wpsl_locator.locations,e="",o='<h3 class="wpsl-results-header">'+a.data.result_count+" "+o;""!==a.data.latitude&&(o+=" "+wpsl_locator.found_within+" "+a.data.distance+" "+a.data.unit+" "+wpsl_locator.of+" "),o+="true"===a.data.geolocation?wpsl_locator.yourlocation:a.data.formatted_address,o+="</h3>",a.paginated&&a.data.results_header&&(o=a.data.results_header,a.data.current_counts&&1<a.data.total_pages&&(o+=a.data.current_counts)),e+=o;o="undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options;for(o&&""!==wpsl_locator_options.resultswrapper&&(e+="<"+wpsl_locator_options.resultswrapper+">"),i=0;i<a.data.results.length;i++)e+=a.data.results[i].output;o&&""!==wpsl_locator_options.resultswrapper&&(e+="</"+wpsl_locator_options.resultswrapper+">"),a.paginated&&1<a.data.total_pages&&(e+='<div class="simple-locator-ajax-pagination">',a.data.back_button&&(e+=a.data.back_button),a.data.next_button&&(e+=a.data.next_button),a.data.loading_spinner&&(e+=a.data.loading_spinner),a.data.page_jump_form&&(e+=a.data.page_jump_form),a.data.page_position&&(e+=a.data.page_position),e+="</div>"),a.toggleLoading(!1),r(a.activeList).removeClass("loading").html(e),r(document).trigger("simple-locator-results-rendered",[a.listIndex,a.activeForm]),wpsl_after_render(a.activeList)},a.toggleLoading=function(o){o?r(a.activeFormContainer).addClass("loading"):r(a.activeFormContainer).removeClass("loading")},a.bindEvents()},(SimpleLocator=SimpleLocator||{}).InfoWindowOpen=function(){var a=this,r=jQuery;return a.mapIndex,a.markerIndex,a.bindEvents=function(){r(document).on("click","["+SimpleLocator.selectors.infoWindowLink+"]",function(o){o.preventDefault(),a.setIndexes(r(this)),a.openInfoWindow()})},a.setIndexes=function(o){var e=r(o).parents("["+SimpleLocator.selectors.resultsWrapper+"]"),t=r("["+SimpleLocator.selectors.resultsWrapper+"]");a.mapIndex=r(e).index(t),a.markerIndex=parseInt(r(o).attr(SimpleLocator.selectors.infoWindowLink))},a.openInfoWindow=function(){google.maps.event.trigger(SimpleLocator.markers[a.mapIndex][a.markerIndex],"click"),r(document).trigger("simple-locator-infowindow-opened",[a.mapIndex,a.markerIndex])},a.bindEvents()},(SimpleLocator=SimpleLocator||{}).Geolocation=function(){var e=this,t=jQuery;return e.geolocationAvailable=!0,e.activeForm,e.activeFormContainer,e.bindEvents=function(){t(document).ready(function(){e.setGeolocationAvailable()}),t(document).on("simple-locator-geolocation-available-set",function(){e.geolocationAvailable&&(e.appendButton(),e.setDefaultUserLocation())}),t(document).on("click","["+SimpleLocator.selectors.geoButton+"]",function(o){o.preventDefault(),e.activeForm=t(this).parents("["+SimpleLocator.selectors.form+"]"),e.activeFormContainer=t(this).parents("["+SimpleLocator.selectors.formContainer+"]"),e.toggleLoading(!0),e.getLocation()})},e.appendButton=function(){var o='<button class="wpsl-geo-button" '+SimpleLocator.selectors.geoButton+">"+wpsl_locator.geobuttontext+"</button>";t(".geo_button_cont").html(o)},e.setDefaultUserLocation=function(){var o;"true"===wpsl_locator.default_user_center&&(o=t("[data-simple-locator-default-enabled]"),e.activeFormContainer=t(o).parents("["+SimpleLocator.selectors.formContainer+"]"),e.activeForm=t(e.activeFormContainer).find("["+SimpleLocator.selectors.form+"]"),t(e.activeFormContainer).addClass("loading"),e.getLocation())},e.setGeolocationAvailable=function(){if("true"===wpsl_locator.showgeobutton){if(t("["+SimpleLocator.selectors.formContainer+"]").removeClass("no-geolocation"),!navigator.geolocation)return!1;navigator.permissions.query({name:"geolocation"}).then(function(o){"denied"==o.state&&(e.geolocationAvailable=!1,t("["+SimpleLocator.selectors.formContainer+"]").addClass("no-geolocation")),t(document).trigger("simple-locator-geolocation-available-set",[e.geolocationAvailable])})}},e.getLocation=function(){navigator.geolocation.getCurrentPosition(function(o){o={latitude:o.coords.latitude,longitude:o.coords.longitude};t(e.activeFormContainer).addClass("has-geolocation"),t(document).trigger("simple-locator-geolocation-success",[e.activeForm,o])},function(o){t(document).trigger("simple-locator-error",[e.activeForm,"Your location could not be determined"]),e.toggleLoading(!1)})},e.toggleLoading=function(o){if(o)return t("["+SimpleLocator.selectors.inputAddress+"]").val(""),t("["+SimpleLocator.selectors.inputLatitude+"]").val(""),t("["+SimpleLocator.selectors.inputLongitude+"]").val(""),t("["+SimpleLocator.selectors.inputGeocode+"]").val(""),t("["+SimpleLocator.selectors.inputFormattedLocation+"]").val(""),t(e.activeFormContainer).addClass("loading"),void t(e.activeFormContainer).find("["+SimpleLocator.selectors.formError+"]").hide();t(e.activeFormContainer).removeClass("loading")},e.bindEvents()},(SimpleLocator=SimpleLocator||{}).PlacesAutocomplete=function(){var e=this,i=jQuery;return e.selectors={input:"data-simple-locator-autocomplete"},e.bindEvents=function(){i(document).ready(function(){e.enableAutocomplete()})},e.enableAutocomplete=function(){var o=i("["+e.selectors.input+"]");i.each(o,function(o,e){var t={};wpsl_locator.custom_autocomplete&&(t=wpsl_locator.autocomplete_options);var a=new google.maps.places.Autocomplete(this,t),r=(i(this).parents("["+SimpleLocator.selectors.form+"]").find("["+SimpleLocator.selectors.submitButton+"]"),i(this).parents("form"));google.maps.event.addListener(a,"place_changed",function(){i(document).trigger("simple-locator-autocomplete-changed",[a.getPlace(),r])})})},e.bindEvents()},(SimpleLocator=SimpleLocator||{}).DefaultMap=function(){var a=this,r=jQuery;return a.mapIndex,a.selectors={map:"data-simple-locator-default-enabled"},a.bindEvents=function(){r(document).ready(function(){"true"!==wpsl_locator.default_user_center&&a.queueDefaultMaps()})},a.queueDefaultMaps=function(o){var e=r("["+a.selectors.map+"]");r.each(e,function(){var o=r(this);a.setMapIndex(o),a.loadDefault(o)})},a.setMapIndex=function(o){var e=r("["+SimpleLocator.selectors.resultsWrapper+"]"),o=r(o).parents("["+SimpleLocator.selectors.resultsWrapper+"]");a.mapIndex=r(e).index(o)},a.loadDefault=function(o){var e=wpsl_locator.default_latitude,t=wpsl_locator.default_longitude;r(o).removeClass("loading");e=new google.maps.LatLng(e,t),t={center:e,zoom:parseInt(wpsl_locator.default_zoom),styles:wpsl_locator.mapstyles};(t="1"===wpsl_locator.custom_map_options?wpsl_locator.map_options:t).center=e,SimpleLocator.maps[a.mapIndex]=new google.maps.Map(o[0],t)},a.bindEvents()},(SimpleLocator=SimpleLocator||{}).AllLocations=function(){var l=this,c=jQuery;return l.data,l.mapIndex,l.activeMap,l.formData={},l.paginated=!1,l.page=1,l.selectors={map:"data-simple-locator-all-locations-map",pagination:"data-simple-locator-all-results-pagination",pageJumpForm:"data-simple-locator-page-jump-form"},l.bindEvents=function(){c("["+l.selectors.map+"]").length<1||(c(document).ready(function(){l.getData()}),c(document).on("click","["+l.selectors.pagination+"] ["+SimpleLocator.selectors.paginationButton+"]",function(o){o.preventDefault(),l.paginate(c(this))}),c(document).on("submit","["+SimpleLocator.selectors.pageJumpForm+"]",function(o){var e=c(this).parents("["+SimpleLocator.selectors.resultsWrapper+"]");c(e).hasClass("non-ajax")||(o.preventDefault(),l.jumpToPage(c(this)))}))},l.setMapIndex=function(){var o=c("["+SimpleLocator.selectors.map+"]");l.mapIndex=c(l.activeMap).index(o),-1===l.mapIndex&&(l.mapIndex=0)},l.setTaxonomyArgs=function(){var o=c(l.activeMap).data(),t={};c.each(o,function(o,e){0===o.indexOf("taxfilter")&&(o=o.substring(9).toLowerCase(),e="number"!=typeof e?e.split(","):[e],t[o]=e)}),l.formData.taxfilter=t},l.setLimitArgs=function(){limit=c(l.activeMap).attr("data-limit"),l.formData.limit="undefined"!=typeof limit&&""!==limit?limit:"-1"},l.setPerPageArgs=function(){perpage=c(l.activeMap).attr("data-per-page"),"undefined"!=typeof perpage&&""!==perpage&&(l.formData.per_page=parseInt(perpage),l.paginated=!0)},l.setIdArgs=function(){var o=c(l.activeMap).attr("data-post-ids");void 0!==o&&""!==o&&(l.formData.ids=o)},l.setOrderArgs=function(){l.formData.orderby=null,l.formData.order="asc";var o=c(l.activeMap).attr("data-orderby");void 0!==o&&""!==o&&(l.formData.orderby=o,o=c(l.activeMap).attr("data-order"),l.formData.order=void 0!==o&&"asc"===o?"asc":"desc")},l.setLocationArgs=function(){var o=wpsl_locator.default_latitude,e=wpsl_locator.default_longitude,t=wpsl_locator.default_enabled;if(void 0!==t&&""!==t)return void 0!==o&&""!==o?(l.formData.latitude=o,l.formData.longitude=e,void(l.formData.distance=5e3)):void(l.formData.allow_empty_address="true");l.formData.allow_empty_address="true"},l.getData=function(){var o=c("["+l.selectors.map+"]");c.each(o,function(){l.activeMap=c(this),l.setMapIndex();var o=c(this).parents("["+SimpleLocator.selectors.formContainer+"]").find("["+SimpleLocator.selectors.form+"]");void 0!==o&&""!==o&&0<o.length&&"1"!==wpsl_locator.default_enabled||(l.formData.page=l.page,l.setLocationArgs(),l.setPerPageArgs(),l.setTaxonomyArgs(),l.setLimitArgs(),l.setIdArgs(),l.setOrderArgs(),c.ajax({url:SimpleLocator.endpoints.search,type:"GET",datatype:"json",data:l.formData,beforeSend:function(o,e){"1"===wpsl_locator.jsdebug&&(console.log("All Locations Form Data"),console.log(l.formData),console.log("URL"),console.log(e.url))},success:function(o){if("1"===wpsl_locator.jsdebug&&(console.log("All Locations Response"),console.log(o)),!o.results)return l.noLocations();SimpleLocator.formData[l.mapIndex]=o,SimpleLocator.formData[l.mapIndex].allLocations=!0,l.data=o,l.loadMap()},error:function(o){"1"===wpsl_locator.jsdebug&&console.log("All Locations Error")}}))})},l.loadMap=function(){SimpleLocator.markers[l.mapIndex]=[];var t=l.data.results,o=wpsl_locator.mapstyles,e=new google.maps.LatLngBounds,o={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:o,panControl:!1};"1"===wpsl_locator.custom_map_options&&(o=wpsl_locator.map_options);var a=new google.maps.InfoWindow;SimpleLocator.infoWindow=a;for(var r=new google.maps.Map(c(l.activeMap)[0],o),i=0;i<t.length;i++){var n=new google.maps.LatLng(t[i].latitude,t[i].longitude);e.extend(n);n=new google.maps.Marker({position:n,map:r,title:t[i].title,icon:t[i].mappin});google.maps.event.addListener(n,"click",function(o,e){return function(){a.setContent(t[e].infowindow),a.open(r,o),c(document).trigger("simple-locator-all-locations-marker-clicked",[o,a,e]),wpsl_all_locations_marker_clicked(o,a)}}(n,i)),SimpleLocator.markers[l.mapIndex].push(n),r.fitBounds(e);var s=google.maps.event.addListener(r,"idle",function(){t.length<2&&r.setZoom(13),google.maps.event.removeListener(s)})}SimpleLocator.maps[l.mapIndex]=r,l.loadList(),c(document).trigger("simple-locator-all-locations-rendered",[r]),wpsl_all_locations_rendered(r)},l.noLocations=function(){var o=void 0===(o=c(l.activeMap).attr("data-no-results-text"))||""===o?wpsl_locator.nolocationsfound:o;c("<p>"+o+"</p>").insertAfter(l.activeMap),c(l.activeMap).hide()},l.loadList=function(){var o=c(l.activeMap).attr("data-include-listing");if(void 0!==o&&"true"===o){var e,t=c("[data-simple-locator-all-locations-results]"),o=c(l.activeMap).parents("["+SimpleLocator.selectors.formContainer+"]");o.length<1?(e=c(l.activeMap).siblings("[data-simple-locator-results-container]")).length<1&&(e=c("<div data-simple-locator-results-container><div "+SimpleLocator.selectors.results+' class="wpsl-results"></div></div>').insertAfter(l.activeMap)):e=c(o).find("["+SimpleLocator.selectors.results+"]"),0<t.length&&(e=c(t));var t=c(l.activeMap).attr(l.selectors.map),a="";(t=void 0!==t&&""!==t&&"true"!==t&&'<h3 class="wpsl-results-header">'+t+"</h3>")&&(a+=t),t||(a+=l.data.results_header,l.data.current_counts&&(a+=l.data.current_counts));t="undefined"!=typeof wpsl_locator_options&&""!==wpsl_locator_options;for(t&&""!==wpsl_locator_options.resultswrapper&&(a+="<"+wpsl_locator_options.resultswrapper+">"),i=0;i<l.data.results.length;i++)a+=l.data.results[i].output;t&&""!==wpsl_locator_options.resultswrapper&&(a+="</"+wpsl_locator_options.resultswrapper+">"),l.paginated&&1<l.data.total_pages&&(a+='<div class="simple-locator-ajax-pagination" data-simple-locator-all-results-pagination>',l.data.back_button&&(a+=l.data.back_button),l.data.next_button&&(a+=l.data.next_button),l.data.loading_spinner&&(a+=l.data.loading_spinner),l.data.page_jump_form&&(a+=l.data.page_jump_form),l.data.page_position&&(a+=l.data.page_position),a+="</div>"),c(e).removeClass("loading").html(a),c(e).parents("["+SimpleLocator.selectors.formContainer+"]").removeClass("loading")}},l.paginate=function(o){if(c(o).siblings(".wpsl-icon-spinner").addClass("visible"),"next"===c(o).attr(SimpleLocator.selectors.paginationButton))return l.page=l.page+1,void l.getData();l.page=l.page-1,l.getData()},l.jumpToPage=function(o){var e,t=parseInt(c(o).find('input[type="tel"]').val());isNaN(t)||(void 0!==(e=SimpleLocator.formData[l.mapIndex].total_pages)&&e<t||(e=c(o).parents("["+SimpleLocator.selectors.formContainer+"]"),o=c(e).index("["+SimpleLocator.selectors.formContainer+"]"),SimpleLocator.formData[o].allLocations&&(c(e).addClass("loading"),l.page=t,l.getData())))},l.bindEvents()},(SimpleLocator=SimpleLocator||{}).Errors=function(){var a=this,r=jQuery;return a.error,a.form,a.formContainer,a.bindEvents=function(){r(document).on("simple-locator-error",function(o,e,t){a.form=e,a.formContainer=r(e).parents("["+SimpleLocator.selectors.formContainer+"]"),a.toggleError(t),r(document).trigger("simple-locator-error-message",[e,t]),a.clearMap(),wpsl_error(t,a.form)})},a.toggleError=function(o){r(a.formContainer).removeClass("loading").addClass("has-error"),r(a.formContainer).find("["+SimpleLocator.selectors.formError+"]").text(o).show()},a.clearMap=function(){var o=r("["+SimpleLocator.selectors.resultsWrapper+"]"),e=r(a.formContainer).index(o);SimpleLocator.markers[e]||(SimpleLocator.markers[e]=[]);for(var t=0;t<SimpleLocator.markers[e].length;t++)SimpleLocator.markers[e][t].setMap(null);SimpleLocator.markers[e]=[],""!==wpsl_locator.includeuserpin&&SimpleLocator.userPin[e]&&(SimpleLocator.userPin[e].setMap(null),SimpleLocator.userPin[e]=null)},a.bindEvents()},jQuery(document).ready(function(){new SimpleLocator.Factory}),(SimpleLocator=SimpleLocator||{}).selectors={resultsWrapper:"data-simple-locator-results-wrapper",form:"data-simple-locator-form",formContainer:"data-simple-locator-form-container",formError:"data-simple-locator-form-error",results:"data-simple-locator-results",map:"data-simple-locator-map",mapNonAjax:"data-simple-locator-map-non-ajax",inputAddress:"data-simple-locator-input-address",inputLatitude:"data-simple-locator-input-latitude",inputLongitude:"data-simple-locator-input-longitude",inputUnit:"data-simple-locator-input-unit",inputDistance:"data-simple-locator-input-distance",inputFormattedLocation:"data-simple-locator-input-formatted-location",inputGeocode:"data-simple-locator-input-geocode",inputLimit:"data-simple-locator-input-limit",submitButton:"data-simple-locator-submit",infoWindowLink:"data-simple-locator-open-infowindow",geoButton:"data-simple-locator-geolocation-button",ajaxForm:"data-simple-locator-ajax-form",paginationButton:"data-simple-locator-pagination",pageJumpForm:"data-simple-locator-page-jump-form"},SimpleLocator.endpoints={search:wpsl_locator.rest_url+"/search",locations:wpsl_locator.rest_url+"/locations"},SimpleLocator.maps=[],SimpleLocator.markers=[],SimpleLocator.userPin=[],SimpleLocator.formData=[],SimpleLocator.infoWindow,SimpleLocator.mapservice=wpsl_locator.mapservice,SimpleLocator.Factory=function(){jQuery;return this.init=function(){new SimpleLocator.Geocoder,new SimpleLocator.Geolocation,new SimpleLocator.PlacesAutocomplete,new SimpleLocator.DefaultMap,new SimpleLocator.ResultsMapNonAjax,new SimpleLocator.SingleLocation,new SimpleLocator.AllLocations,new SimpleLocator.Form,new SimpleLocator.ResultsMap,new SimpleLocator.ResultsList,new SimpleLocator.InfoWindowOpen,new SimpleLocator.Errors},this.init()};